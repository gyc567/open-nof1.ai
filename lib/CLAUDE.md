# Lib æ¨¡å— - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

> åŒ…å«AIå†³ç­–ã€äº¤æ˜“æ‰§è¡Œã€å·¥å…·å‡½æ•°ç­‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

[ğŸ  è¿”å›æ ¹ç›®å½•](../CLAUDE.md)

## ğŸ“ æ¨¡å—ç»“æ„

```
lib/
â”œâ”€â”€ ai/                    # AIå†³ç­–æ¨¡å—
â”‚   â”œâ”€â”€ model.ts          # æ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ prompt.ts         # æç¤ºå·¥ç¨‹
â”‚   â”œâ”€â”€ run.ts           # AIæ‰§è¡Œé€»è¾‘
â”‚   â””â”€â”€ tool.ts          # AIå·¥å…·å‡½æ•°
â”œâ”€â”€ trading/              # äº¤æ˜“æ‰§è¡Œæ¨¡å—
â”‚   â”œâ”€â”€ binance.ts       # äº¤æ˜“æ‰€è¿æ¥
â”‚   â”œâ”€â”€ buy.ts          # ä¹°å…¥æ“ä½œ
â”‚   â”œâ”€â”€ sell.ts         # å–å‡ºæ“ä½œ
â”‚   â”œâ”€â”€ current-market-state.ts    # å¸‚åœºåˆ†æ
â”‚   â””â”€â”€ account-information-and-performance.ts  # è´¦æˆ·ç®¡ç†
â”œâ”€â”€ types/               # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ metrics.ts      # æŒ‡æ ‡ç±»å‹
â”œâ”€â”€ utils.ts            # å·¥å…·å‡½æ•°
â””â”€â”€ icons.tsx          # å›¾æ ‡ç»„ä»¶
```

## ğŸ§  AIå†³ç­–æ¨¡å— (`ai/`)

### æ¨¡å‹é…ç½® (`model.ts`)
- **DeepSeek V3.2**: ä¸»è¦äº¤æ˜“æ¨¡å‹
- **DeepSeek R1**: æ¨ç†æ¨¡å‹
- **OpenRouter**: å¤šæ¨¡å‹æ”¯æŒ

### æç¤ºå·¥ç¨‹ (`prompt.ts`)
- äº¤æ˜“å†³ç­–æç¤ºæ¨¡æ¿
- å¸‚åœºåˆ†ææç¤º
- é£é™©è¯„ä¼°æç¤º

### AIæ‰§è¡Œ (`run.ts`)
- æ¨¡å‹è°ƒç”¨å°è£…
- æ€ç»´é“¾ç”Ÿæˆ
- å†³ç­–ç»“æœè§£æ

### å·¥å…·å‡½æ•° (`tool.ts`)
- AIå·¥å…·å®šä¹‰
- å‡½æ•°è°ƒç”¨å¤„ç†
- å‚æ•°éªŒè¯

## ğŸ’¹ äº¤æ˜“æ‰§è¡Œæ¨¡å— (`trading/`)

### äº¤æ˜“æ‰€è¿æ¥ (`binance.ts`)
- CCXT Binance Futuresé…ç½®
- æ²™ç›’æ¨¡å¼æ”¯æŒ
- APIå¯†é’¥ç®¡ç†

### äº¤æ˜“æ“ä½œ
- `buy.ts`: ä¹°å…¥æ‰§è¡Œé€»è¾‘
- `sell.ts`: å–å‡ºæ‰§è¡Œé€»è¾‘
- æ æ†è®¾ç½®
- æ­¢æŸæ­¢ç›ˆ

### å¸‚åœºåˆ†æ
- `current-market-state.ts`: å½“å‰å¸‚åœºçŠ¶æ€
- ä»·æ ¼è¶‹åŠ¿åˆ†æ
- æŠ€æœ¯æŒ‡æ ‡è®¡ç®—

### è´¦æˆ·ç®¡ç†
- `account-information-and-performance.ts`
- ä½™é¢æŸ¥è¯¢
- æŒä»“ç®¡ç†
- ç›ˆäºè®¡ç®—

## ğŸ› ï¸ å·¥å…·æ¨¡å—

### ç±»å‹å®šä¹‰ (`types/`)
- æŒ‡æ ‡æ•°æ®ç±»å‹
- äº¤æ˜“æ•°æ®ç±»å‹
- AIå“åº”ç±»å‹

### é€šç”¨å·¥å…· (`utils.ts`)
- æ—¥æœŸå¤„ç†
- æ•°å­—æ ¼å¼åŒ–
- é”™è¯¯å¤„ç†

### å›¾æ ‡ç»„ä»¶ (`icons.tsx`)
- Reactå›¾æ ‡ç»„ä»¶
- ç»Ÿä¸€å›¾æ ‡ç®¡ç†

## ğŸ”„ ä¾èµ–å…³ç³»

```mermaid
graph LR
    A[AIæ¨¡å—] --> B[äº¤æ˜“æ¨¡å—]
    B --> C[Binance API]
    C --> D[æ•°æ®åº“]
    
    E[å‰ç«¯ç»„ä»¶] --> A
    E --> B
    
    F[å®šæ—¶ä»»åŠ¡] --> A
    F --> B
```

## ğŸ¯ æ ¸å¿ƒæ¥å£

### AIå†³ç­–æ¥å£
```typescript
// å¸‚åœºåˆ†æ
analyzeMarket(symbols: string[]): Promise<MarketAnalysis>

// äº¤æ˜“å†³ç­–
makeTradingDecision(marketData: MarketData): Promise<TradingDecision>

// æ€ç»´é“¾ç”Ÿæˆ
generateReasoning(prompt: string): Promise<ReasoningChain>
```

### äº¤æ˜“æ‰§è¡Œæ¥å£
```typescript
// è´¦æˆ·ä¿¡æ¯
getAccountInfo(): Promise<AccountInfo>

// ä¹°å…¥æ“ä½œ
buy(symbol: string, amount: number, leverage?: number): Promise<TradeResult>

// å–å‡ºæ“ä½œ
sell(symbol: string, amount: number): Promise<TradeResult>

// å¸‚åœºçŠ¶æ€
getCurrentMarketState(): Promise<MarketState>
```

## ğŸ“Š æ•°æ®æµ

```
å¸‚åœºæ•°æ® â†’ AIåˆ†æ â†’ äº¤æ˜“å†³ç­– â†’ æ‰§è¡Œç¡®è®¤ â†’ ç»“æœè®°å½•
     â†“          â†“          â†“          â†“          â†“
 ä»·æ ¼ä¿¡æ¯   æ€ç»´é“¾     ä¹°å…¥/å–å‡º   äº¤æ˜“æ‰€API   æ•°æ®åº“
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°AIæ¨¡å‹
1. åœ¨ `model.ts` ä¸­æ·»åŠ æ¨¡å‹é…ç½®
2. åœ¨ `prompt.ts` ä¸­å®šä¹‰ä¸“ç”¨æç¤º
3. åœ¨ `run.ts` ä¸­å®ç°è°ƒç”¨é€»è¾‘

### æ·»åŠ æ–°äº¤æ˜“å¯¹
1. æ›´æ–° `prisma/schema.prisma` ä¸­çš„ Symbol æšä¸¾
2. åœ¨äº¤æ˜“é€»è¾‘ä¸­æ”¯æŒæ–°äº¤æ˜“å¯¹
3. æ›´æ–°å‰ç«¯æ˜¾ç¤º

### è°ƒè¯•äº¤æ˜“é€»è¾‘
```bash
# æµ‹è¯•ä¹°å…¥é€»è¾‘
bun run scripts/manual-trigger.js

# è°ƒè¯•è®¤è¯
bun run scripts/debug-cron-auth.js
```

## âš ï¸ æ³¨æ„äº‹é¡¹

- æ‰€æœ‰äº¤æ˜“æ“ä½œéƒ½éœ€è¦å®Œæ•´çš„å‚æ•°éªŒè¯
- AIå†³ç­–å¿…é¡»æœ‰å®Œæ•´çš„æ€ç»´é“¾è®°å½•
- äº¤æ˜“æ‰€APIè°ƒç”¨éœ€è¦é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- æ•æ„Ÿæ“ä½œéœ€è¦æ—¥å¿—è®°å½•

---

**ğŸ§  æ™ºèƒ½å†³ç­– + ğŸ’¹ ç²¾å‡†æ‰§è¡Œ = ğŸ“ˆ æŒç»­ç›ˆåˆ©**