# App æ¨¡å— - Next.js åº”ç”¨å±‚

> åŒ…å«å‰ç«¯ç•Œé¢ã€APIè·¯ç”±ã€å®šæ—¶ä»»åŠ¡ç­‰åº”ç”¨å±‚é€»è¾‘

[ğŸ  è¿”å›æ ¹ç›®å½•](../CLAUDE.md)

## ğŸ“ æ¨¡å—ç»“æ„

```
app/
â”œâ”€â”€ api/                    # APIè·¯ç”±
â”‚   â”œâ”€â”€ cron/              # å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ 20-seconds-metrics-interval/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts   # 20ç§’æŒ‡æ ‡æ”¶é›†
â”‚   â”‚   â””â”€â”€ 3-minutes-run-interval/
â”‚   â”‚       â””â”€â”€ route.ts   # 3åˆ†é’Ÿäº¤æ˜“æ‰§è¡Œ
â”‚   â”œâ”€â”€ metrics/           # æŒ‡æ ‡API
â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”œâ”€â”€ pricing/           # å®šä»·API
â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â””â”€â”€ model/chat/        # èŠå¤©å†å²API
â”‚       â””â”€â”€ route.ts
â”œâ”€â”€ layout.tsx             # åº”ç”¨å¸ƒå±€
â”œâ”€â”€ page.tsx              # ä¸»é¡µé¢
â””â”€â”€ globals.css           # å…¨å±€æ ·å¼
```

## ğŸ”„ å®šæ—¶ä»»åŠ¡æ¨¡å— (`api/cron/`)

### 20ç§’æŒ‡æ ‡æ”¶é›† (`20-seconds-metrics-interval/route.ts`)
- **é¢‘ç‡**: æ¯20ç§’æ‰§è¡Œ
- **åŠŸèƒ½**: æ”¶é›†è´¦æˆ·ä½™é¢ã€æŒä»“ã€ç›ˆäºç­‰æŒ‡æ ‡
- **è®¤è¯**: Bearer TokenéªŒè¯
- **æ•°æ®å­˜å‚¨**: å†™å…¥Metricsè¡¨

### 3åˆ†é’Ÿäº¤æ˜“æ‰§è¡Œ (`3-minutes-run-interval/route.ts`)
- **é¢‘ç‡**: æ¯3åˆ†é’Ÿæ‰§è¡Œ
- **åŠŸèƒ½**: AIåˆ†æå¸‚åœº â†’ ç”Ÿæˆäº¤æ˜“å†³ç­– â†’ æ‰§è¡Œäº¤æ˜“
- **è®¤è¯**: Bearer TokenéªŒè¯
- **æ•°æ®å­˜å‚¨**: å†™å…¥Chatå’ŒTradingè¡¨

## ğŸ“Š æ•°æ®APIæ¨¡å— (`api/`)

### æŒ‡æ ‡æŸ¥è¯¢ (`metrics/route.ts`)
- **GET**: è·å–å†å²æŒ‡æ ‡æ•°æ®
- **æŸ¥è¯¢å‚æ•°**: æ—¶é—´èŒƒå›´ã€æ¨¡å‹ç±»å‹
- **å“åº”**: JSONæ ¼å¼æŒ‡æ ‡æ•°ç»„

### å®šä»·ä¿¡æ¯ (`pricing/route.ts`)
- **GET**: è·å–åŠ å¯†è´§å¸å®æ—¶ä»·æ ¼
- **æ”¯æŒå¸ç§**: BTC, ETH, SOL, BNB, DOGE
- **æ•°æ®æº**: Binance API

### èŠå¤©å†å² (`model/chat/route.ts`)
- **GET**: è·å–AIå†³ç­–æ€ç»´é“¾
- **æŸ¥è¯¢å‚æ•°**: æ—¶é—´èŒƒå›´ã€æ¨¡å‹ç±»å‹
- **å“åº”**: å®Œæ•´çš„AIæ¨ç†è¿‡ç¨‹

## ğŸ¨ å‰ç«¯ç•Œé¢

### ä¸»é¡µé¢ (`page.tsx`)
- **å®æ—¶ä»ªè¡¨æ¿**: è´¦æˆ·æ€»å€¼ã€ç›ˆäºç»Ÿè®¡
- **åŠ å¯†è´§å¸å¡ç‰‡**: å®æ—¶ä»·æ ¼æ˜¾ç¤º
- **äº¤æ˜“å†å²**: ä¹°å…¥/å–å‡ºè®°å½•
- **AIæ€ç»´é“¾**: å†³ç­–è¿‡ç¨‹å±•ç¤º

### åº”ç”¨å¸ƒå±€ (`layout.tsx`)
- **å…¨å±€å¯¼èˆª**: é¡µé¢ç»“æ„å®šä¹‰
- **æ ·å¼é…ç½®**: Tailwind CSSè®¾ç½®
- **å…ƒæ•°æ®**: SEOä¼˜åŒ–

### å…¨å±€æ ·å¼ (`globals.css`)
- **TailwindåŸºç¡€æ ·å¼**
- **è‡ªå®šä¹‰ç»„ä»¶æ ·å¼**
- **å“åº”å¼è®¾è®¡**

## ğŸ”„ å·¥ä½œæµé›†æˆ

```mermaid
graph TB
    subgraph "å®šæ—¶ä»»åŠ¡"
        A[20ç§’æŒ‡æ ‡æ”¶é›†] --> B[æ•°æ®åº“å­˜å‚¨]
        C[3åˆ†é’ŸAIå†³ç­–] --> D[äº¤æ˜“æ‰§è¡Œ]
        D --> E[ç»“æœè®°å½•]
    end
    
    subgraph "å‰ç«¯å±•ç¤º"
        F[ä»ªè¡¨æ¿] --> G[æŒ‡æ ‡å›¾è¡¨]
        F --> H[äº¤æ˜“å†å²]
        F --> I[AIæ€ç»´é“¾]
    end
    
    subgraph "æ•°æ®API"
        J[æŒ‡æ ‡æŸ¥è¯¢] --> K[å‰ç«¯æ•°æ®]
        L[å®šä»·ä¿¡æ¯] --> M[å®æ—¶ä»·æ ¼]
        N[èŠå¤©å†å²] --> O[å†³ç­–è¿‡ç¨‹]
    end
    
    B --> J
    E --> N
    K --> F
    M --> F
    O --> F
```

## ğŸ› ï¸ APIæ¥å£è§„èŒƒ

### è®¤è¯è¦æ±‚
æ‰€æœ‰å®šæ—¶ä»»åŠ¡APIéœ€è¦Bearer Tokenè®¤è¯ï¼š
```typescript
Authorization: Bearer ${CRON_SECRET_KEY}
```

### å“åº”æ ¼å¼
```typescript
{
  "success": boolean,
  "data": any,
  "error": string | null
}
```

### é”™è¯¯å¤„ç†
- 400: å‚æ•°é”™è¯¯
- 401: è®¤è¯å¤±è´¥
- 500: æœåŠ¡å™¨é”™è¯¯

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å®šæ—¶ä»»åŠ¡
- ä½¿ç”¨è½»é‡çº§å¤„ç†é€»è¾‘
- é¿å…é•¿æ—¶é—´é˜»å¡
- é”™è¯¯é‡è¯•æœºåˆ¶

### æ•°æ®æŸ¥è¯¢
- æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- åˆ†é¡µæŸ¥è¯¢æ”¯æŒ
- ç¼“å­˜ç­–ç•¥

### å‰ç«¯æ¸²æŸ“
- React Server Components
- é™æ€ç”Ÿæˆä¼˜åŒ–
- å›¾ç‰‡æ‡’åŠ è½½

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°APIè·¯ç”±
1. åœ¨ `app/api/` ä¸‹åˆ›å»ºæ–°ç›®å½•
2. å®ç° `route.ts` æ–‡ä»¶
3. å®šä¹‰HTTPæ–¹æ³•å¤„ç†
4. æ·»åŠ ç±»å‹å®šä¹‰

### è°ƒè¯•å®šæ—¶ä»»åŠ¡
```bash
# æµ‹è¯•æŒ‡æ ‡æ”¶é›†
curl -X POST http://localhost:3000/api/cron/20-seconds-metrics-interval \
  -H "Authorization: Bearer YOUR_SECRET"

# æµ‹è¯•äº¤æ˜“æ‰§è¡Œ
curl -X POST http://localhost:3000/api/cron/3-minutes-run-interval \
  -H "Authorization: Bearer YOUR_SECRET"
```

### ç¯å¢ƒé…ç½®
```bash
# å®šæ—¶ä»»åŠ¡å¯†é’¥ç”Ÿæˆ
bun run scripts/generate-cron-secret.js

# APIæµ‹è¯•
bun run scripts/test-cron-endpoints.js
```

## âš ï¸ æ³¨æ„äº‹é¡¹

- å®šæ—¶ä»»åŠ¡éœ€è¦å¤–éƒ¨cronæœåŠ¡è°ƒç”¨
- APIè®¤è¯å¯†é’¥éœ€è¦å®‰å…¨å­˜å‚¨
- ç”Ÿäº§ç¯å¢ƒéœ€è¦HTTPS
- æ•°æ®åº“è¿æ¥éœ€è¦è¿æ¥æ± ç®¡ç†

---

**ğŸ”„ å®æ—¶æ•°æ® + ğŸ§  AIå†³ç­– + ğŸ’¹ ç²¾å‡†æ‰§è¡Œ = ğŸ“Š å®Œæ•´äº¤æ˜“ç³»ç»Ÿ**